---
title: "STA13824 - Análise de regressão"
subtitle: "Estimação dos parâmetros"
author: "Fabio A. Fajardo Molinares"
institute: "LECON/DEST - UFES"
date: "Vitória. ES - `r format(Sys.Date(), format='%d/%m/%Y')`"
output:
  xaringan::moon_reader:
    includes:
      after_body: insert-logo.html
    css: [xaringan-themer.css, "https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css"]
    lib_dir: libs
    nature:
      ratio: '16:9' 
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

class: animated, fadeIn
```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer); library(dplyr); library("DT"); library(plotly) #library(icons)
style_mono_light(base_color = "#23395b")
```
```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```
```{r, load_refs, include=FALSE, cache=FALSE}
library("RefManageR"); library("bibtex")
BibOptions(check.entries = FALSE,
           bib.style = "authoryear",
           cite.style = "authoryear",
           style = "markdown",
           hyperlink = FALSE,
           dashed = FALSE)
myBib <- ReadBib("ref_ementa.bib", check = FALSE)
```

<style> body {text-align: justify} </style> <!-- Justify text. -->


### Alguns resultados da álgebra matricial - I
* **Trasposta**: A trasposta de uma matriz $\mathbf{A}$ é a matriz que se obtém 
da troca das linhas pelas colunas da matriz, ou seja, se 
$\mathbf{A}=(a_{ij})_{i,j=1}^{m,n}$, então $\mathbf{A}'=(a_{ij})_{i,j=1}^{n,m}$.
Em outras palavras,

<div class="math">
\[\mathbf{A}=\left[
\begin{array}{ccccc}
a_{11}&a_{12}&a_{13}&\cdots&a_{1n} \\
a_{21}&a_{22}&a_{23}&\cdots&a_{2n} \\
\vdots&\vdots&\vdots&\ddots&\vdots\\
a_{m1}&a_{m2}&a_{m3}&\cdots&a_{mn} \\
\end{array}
\right]
\qquad 
\mathbf{A}'=\left[
\begin{array}{ccccc}
a_{11}&a_{21}&a_{31}&\cdots&a_{m1} \\
a_{12}&a_{22}&a_{32}&\cdots&a_{m2} \\
\vdots&\vdots&\vdots&\ddots&\vdots\\
a_{1n}&a_{2n}&a_{3n}&\cdots&a_{mn} \\
\end{array}
\right]
\]
</div>

**Propriedades**: Sejam $\mathbf{A}$ e $\mathbf{B}$ matrizes com dimensões adequadas.
1. $\left(\mathbf{A}'\right)'=\mathbf{A}$;
1. $(\mathbf{A}+\mathbf{B})'=\mathbf{A}'+\mathbf{B}'$;
1. $\left(c\mathbf{A}\right)'=c\mathbf{A}'$;
1. $\left(\mathbf{AB}\right)'=\mathbf{B}'\mathbf{A}'$;
1. $\left(\mathbf{A}'\right)^{-1}=\left(\mathbf{A}^{-1}\right)'$, $\, \mathbf{A}$ 
não-singular;
1. $\det\left(\mathbf{A}'\right)=\det\left(\mathbf{A}\right)$;


---
class: animated, slideInRight

### Alguns resultados da álgebra matricial - II
* **Simétrica**: Uma matriz quadrada $\mathbf{A}$ é simétrica se $\mathbf{A}=\mathbf{A}'$.

**Exemplos**: Seja $\mathbf{A}$ uma matriz quadrada, então as matrizes
$\mathbf{A}'+\mathbf{A}$ e $\mathbf{A}\mathbf{A}'=\mathbf{A}'\mathbf{A}$ são
simétricas.

* **Autovalores**: Seja $\lambda$ um escalar. Dizemos que $\lambda$ é *autovalor*
de uma matriz quadrada $\mathbf{A}$, se existe um vetor não-nulo $\mathbf{x}$,
tal que

$$\mathbf{Ax}=\lambda\mathbf{x}$$
ou equivalentemente

$$\left(\mathbf{A}-\lambda\mathbf{I}\right)\mathbf{x}=\mathbf{0}.$$
Fica evidente que $\lambda$ é *autovalor* de $\mathbf{A}$ see a matriz
$\mathbf{A}-\lambda\mathbf{I}$ é singular, i.e., $\lambda$ é *autovalor* da
$\mathbf{A}$ see 
$$\det\left(\mathbf{A}-\lambda\mathbf{I}\right)=\left|\mathbf{A}-\lambda\mathbf{I}\right|=0.$$
---
class: animated, slideInRight

### Alguns resultados da álgebra matricial - III

* **Formas quadráticas**:  Uma forma quadrática em $\mathbb{R}^n$ é uma função 
polinomial em que todos os termos são de segundo grau. Em outras palavras,
seja $\mathbf{A}$ uma matriz simétrica e considere um vetor 
$\mathbf{x}=\left(x_1,x_2,\ldots,x_n\right)'$, então

$$\mathbf{x}'\mathbf{Ax}=\sum_{i,j}a_{ij}x_ix_j=\sum_{i=1}^na_{ii}x_i^2+2\sum_{i<j}a_{ij}x_ix_j$$
é uma *forma quadrática*.

* **Derivada de formas quadráticas**<sup>1</sup>: Seja $\mathbf{A}$ uma matriz simétrica e 
$\mathbf{x}'\mathbf{Ax}$ a forma quadrática associada à matriz. Então:
  - $\frac{\partial\mathbf{x}'\mathbf{Ax}}{\partial\mathbf{x}}=2\mathbf{Ax}$;
  - $\frac{\partial^2\mathbf{x}'\mathbf{Ax}}{\partial\mathbf{x}\partial\mathbf{x}'}=2\mathbf{A}$;
  - $\frac{\partial\mathbf{x}'\mathbf{Ax}}{\partial\mathbf{A}}=\mathbf{x}\mathbf{x}'$.
   
> Para formas lineares, considere $\mathbf{Ax}$, então 
$\frac{\partial\mathbf{Ax}}{\partial\mathbf{x}'}=\mathbf{A}$ e
$\frac{\partial\left(\mathbf{Ax}\right)'}{\partial\mathbf{x}}=\mathbf{A}'$. 


<font size="2"> <sup>1</sup>Para detalhes ver `r Citet(myBib, "magnus2019")` e 
`r Citet(myBib, "harville97")`.</font>

---
class: animated, slideInRight

### Alguns resultados da álgebra matricial - IV

* **Matriz definida positiva**: Uma matriz quadrada $\mathbf{A}$ se diz *definida positiva*
se a forma quadrática associada à matriz é positiva, isto é, $\mathbf{x}'\mathbf{Ax}>0$,
para todo $\mathbf{x}\ne\mathbf{0}$.

  - Uma matriz simétrica $\mathbf{A}$ se diz *definida negativa* se $-\mathbf{A}$ é
definida positiva;
  -  Uma matriz simétrica $\mathbf{A}$ se diz *semidefinida positiva* se 
  $\mathbf{x}'\mathbf{Ax}\ge0$, para todo $\mathbf{x}\ne\mathbf{0}$;
  - Uma matriz simétrica $\mathbf{A}$ se diz *semidefinida negativa* se $-\mathbf{A}$ é
semidefinida positiva.

* **Propriedades**<sup>2</sup>: Seja $\mathbf{A}$ uma matriz 
simétrica definida positiva, então
  - $\mathbf{A}$ é não-singular;
  - Os autovalores de $\mathbf{A}$ são todos positivos;
  - $\mathbf{A}^{-1}$ é positiva definida.


<br></br><br></br>

<font size="2"> <sup>2</sup> Para detalhes ver `r Citet(myBib, "searle2017")`.</font>


---
class: inverse, hide-logo, middle, center

# A2. A matriz $\mathbf{X}$ tem posto coluna completo 

---
class: animated, bounceInDown

### Mínimos quadrados ordinários (MQO) - I

Considere o modelo é linear, dado por

$$Y=\mathbf{X\,\beta}+\mathbf{\epsilon}.$$
ou
$$Y=\beta_0\mathbf{1}+\beta_1\mathbf{x}_1+\beta_2\mathbf{x}_2+\cdots+\beta_k\mathbf{x}_k+\mathbf{\epsilon}.$$
Nosso objetivo é estimar o vetor de parâmetros $\mathbf{\beta}$. O método de
mínimos quadrados é um dos tantos métodos existentes na literatura, que 
permitirá atingir nosso objetivo. 

O método MQO tem como meta minimizar a seguinte função objetivo

<div class="math">
$$
\begin{aligned}
S(\mathbf{\beta})=\mathbf{\epsilon}'\mathbf{\epsilon}&=(Y-\mathbf{X\,\beta})'(Y-\mathbf{X\,\beta}) \\
&=Y'Y-Y'\mathbf{X\beta}-\mathbf{\beta}'\mathbf{X}'Y+\mathbf{\beta}'\mathbf{X}'\mathbf{X\beta}\\
&=Y'Y-2Y'\mathbf{X\beta}+\mathbf{\beta}'\mathbf{X}'\mathbf{X\beta}.
\end{aligned}
$$
</div>

Dessa forma,
$$
\widehat{\mathbf{\beta}}=\underset{\mathbf{\beta}\,\in\,\Theta}{\arg\min}\, S(\mathbf{\beta}).
$$

---
class: animated, slideInRight

### Mínimos quadrados ordinários (MQO) - II

A minimização se dá ao derivar $S(\mathbf{\beta})$ em relação ao $\mathbf{\beta}$
e igualar a vetor $\mathbf{0}$, daí

$$
\frac{\partial S(\mathbf{\beta})}{\partial\beta}=-2\mathbf{X}'Y+2\mathbf{X}'\mathbf{X\beta}.
$$
Igualando a $\mathbf{0}$, temos que

$$
\mathbf{X}'\mathbf{X\widehat{\beta}}=\mathbf{X}'Y.
$$
O sistema de equações acima é denominado **equações normais**. O nome deve-se
a que podemos reescrever o sistema de equações como

$$
\mathbf{X}'\left(\mathbf{X\widehat{\beta}}-Y\right)=\mathbf{0}.
$$
O vetor $\mathbf{X\widehat{\beta}}-Y$ é chamado de *vetor de resíduos* e, segundo
a equação acima, esse vetor é *normal* (ortogonal) aos vetores linha de $\mathbf{X}$.

---
class: animated, slideInRight

### Mínimos quadrados ordinários (MQO) - III


De acordo com **A2.**, a matriz $\mathbf{X}$ tem posto coluna completo, então
$\mathbf{X}'\mathbf{X}$ é uma matrix simétrica e não-singular, ou seja,
$\mathbf{X}'\mathbf{X}$ tem inversa. Dessa forma,

<div class="math">
$$
\begin{aligned}
\mathbf{\widehat{\beta}}=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'Y.
\end{aligned}
$$
</div>

Para o ponto crítico ser ponto de mínimo, calcula-se a segunda derivada da função 
objetivo $S(\mathbf{\beta})$ e verifica-se se a matriz resultante é definida
positiva. Dessa forma,

$$\frac{\partial^2 S(\mathbf{\beta})}{\partial\beta\partial\beta'}=2\mathbf{X}'\mathbf{X}.$$
Seja $\mathbf{v}=\mathbf{Xc}$, para algum vetor não-nulo $\mathbf{c}$. Seja 
$q=\mathbf{v}'\mathbf{v}$. Observe que, a menos que cada elemento de 
$\mathbf{v}$ seja zero, $q$ é positivo. Por outra parte, se $\mathbf{v}$ pudesse 
ser zero, então $\mathbf{v}$ seria uma combinação linear das colunas de $\mathbf{X}$
iguai a zero, o que contradiz a suposição **A2**. Dessa forma $q>0$, i.e., 
$\mathbf{X}'\mathbf{X}$ é definida positiva.

> Se $\mathbf{X}$ tem posto coluna completo, então a solução das **equações normais**
é <ins>única</ins> e minimiza $S(\mathbf{\beta})$.


---
class: inverse, hide-logo, middle, center

# A3. Exogeneidade das variáveis independentes

---
class: animated, bounceInDown

### Mínimos quadrados ordinários (MQO) - IV

#### Propriedades do estimador

Sabemos que o estimador MQO é dado por

<div class="math">
$$
\begin{aligned}
\mathbf{\widehat{\beta}}&=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'Y
=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\left(\mathbf{X\beta}+\mathbf{\epsilon}\right)\\
&=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\mathbf{X\beta}+\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\mathbf{\epsilon}=\mathbf{\beta}+\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\mathbf{\epsilon}.
\end{aligned}
$$
</div>

Daí, pela Suposição **A3.**, i.e., $\mathbb{E}[\mathbf{\epsilon}|\mathbf{X}]=\mathbf{0}$,
temos que:

$$\mathbb{E}\left[\widehat{\mathbf{\beta}}\,\big|\,\mathbf{X}\right]=\mathbf{\beta}+\mathbb{E}\left[\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\mathbf{\epsilon}\,\big|\,\mathbf{X}\right]=\mathbf{\beta}+\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\mathbb{E}\left[\mathbf{\epsilon}\,\big|\,\mathbf{X}\right]=\mathbf{\beta}.$$
> Pelas Suposições **A1-A3**, o estimador MQO é não-viesado para $\mathbf{\beta}$.

---
class: inverse, hide-logo, middle, center

# A4. Esfericidade dos erros

---
class: animated, bounceInDown

### Mínimos quadrados ordinários (MQO) - IV

#### Propriedades do estimador - II

Sabemos que,

$$\mathbf{\widehat{\beta}}-\mathbf{\beta}=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\mathbf{\epsilon}.$$
Dessa forma,

<div class="math">
$$
\begin{aligned}
\textrm{cov}\left[\widehat{\beta}\,\big|\,\mathbf{X}\right]&=\mathbb{E}\left[\left(\mathbf{\widehat{\beta}}-\mathbf{\beta}\right)\left(\mathbf{\widehat{\beta}}-\mathbf{\beta}\right)'\,\Big|\,\mathbf{X}\right]=\mathbb{E}\left[\left(\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\mathbf{\epsilon}\right)\left(\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\mathbf{\epsilon}\right)'\,\Big|\,\mathbf{X}\right]\\
&=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\mathbb{E}\left[\mathbf{\epsilon}\mathbf{\epsilon}'\,\big|\,\mathbf{X}\right]\mathbf{X}\left(\mathbf{X}'\mathbf{X}\right)^{-1}.
\end{aligned}
$$
</div>

Pela Suposição **A4.**, i.e., $\mathbb{E}[\mathbf{\epsilon\epsilon}'|\mathbf{X}]=\sigma^2\mathbf{I}$,
temos que


<div class="math">
$$
\begin{aligned}
\textrm{cov}\left[\widehat{\beta}\,\big|\,\mathbf{X}\right]&=\left(\mathbf{X}'\mathbf{X}\right)^{-1}\mathbf{X}'\sigma^2\mathbf{I}\mathbf{X}\left(\mathbf{X}'\mathbf{X}\right)^{-1}\\
&=\sigma^2\left(\mathbf{X}'\mathbf{X}\right)^{-1}.
\end{aligned}
$$
</div>

> Pelas Suposições **A1-A4**, $\textrm{cov}\left[\widehat{\beta}\,\big|\,\mathbf{X}\right]=\sigma^2\left(\mathbf{X}'\mathbf{X}\right)^{-1}$.


---
class: animated, lightSpeedIn
# Referências

```{r refs, echo=FALSE, results="asis"}
PrintBibliography(myBib, .opts = list(check.entries = FALSE))
```

---
class: animated, hide-logo, bounceInDown
## Política de proteção aos direitos autorais

> <span style="color:grey">O conteúdo disponível consiste em material protegido pela legislação brasileira, sendo certo que, por ser
o detentor dos direitos sobre o conteúdo disponível na plataforma, o **LECON** e o **NEAEST** detém direito
exclusivo de usar, fruir e dispor de sua obra, conforme Artigo 5<sup>o</sup>, inciso XXVII, da Constituição Federal
e os Artigos 7<sup>o</sup> e 28<sup>o</sup>, da Lei 9.610/98.
A divulgação e/ou veiculação do conteúdo em sites diferentes à plataforma e sem a devida autorização do
**LECON** e o **NEAEST**, pode configurar violação de direito autoral, nos termos da Lei 9.610/98, inclusive podendo
caracterizar conduta criminosa, conforme Artigo 184<sup>o</sup>, §1<sup>o</sup> a 3<sup>o</sup>, do Código Penal.
É considerada como contrafação a reprodução não autorizada, integral ou parcial, de todo e qualquer
conteúdo disponível na plataforma.</span>

.pull-left[
```{r, out.width='50%', fig.align='center', fig.cap='',echo=FALSE}
knitr::include_graphics("images/logo_lecon.png")
```
]
.pull-right[
```{r, out.width='50%', fig.align='center', fig.cap='',echo=FALSE}
knitr::include_graphics("images/logo_neaest.png")
```
]
<br></br>
.center[
[https://lecon.ufes.br](https://lecon.ufes.br/) &emsp; &emsp;  &emsp; &emsp; [https://analytics.ufes.br](https://analytics.ufes.br)
]

<font size="2"><span style="color:grey">Material elaborado pela equipe LECON/NEAEST: 
Alessandro J. Q. Sarnaglia, Bartolomeu Zamprogno, Fabio A. Fajardo, Luciana G. de Godoi 
e Nátaly A. Jiménez.</span></font>
