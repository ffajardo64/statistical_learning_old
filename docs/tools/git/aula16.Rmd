---
title: "STA13824 - Análise de regressão"
subtitle: "Violação de suposições: Normalidade"
author: "<br/><br/>"
institute: "LECON/DEST - UFES"
date: "Vitória, ES. - `r format(Sys.Date(), format='%d/%m/%Y')`"
output:
  xaringan::moon_reader:
    includes:
      after_body: ["insert-logo.html"]
    css: [xaringan-themer.css, "https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css"]
    lib_dir: libs
    nature:
      ratio: '16:9' 
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

class: animated, fadeIn
```{r xaringan-themer, include=FALSE, warning=FALSE}
library("xaringanthemer"); library("dplyr"); library("DT"); library("plotly")
style_mono_light(base_color = "#23395b")
```
```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```
```{r, load_refs, include=FALSE, cache=FALSE}
library("RefManageR"); library("bibtex")
BibOptions(check.entries = FALSE,
           bib.style = "authoryear",
           cite.style = "authoryear",
           style = "markdown",
           hyperlink = FALSE,
           dashed = FALSE)
myBib <- ReadBib("ref_ementa.bib", check = FALSE)
```

<style> body {text-align: justify} </style> <!-- Justify text. -->

### A5. Normalidade dos erros

* A suposição de que os resíduos são normalmente distribuídos não é necessária para 
calcular as estimativas dos parâmetros da regressão. A normalidade é necessária 
apenas para testes de significância e a construção de intervalos de confiança 
dos parâmetros. Os testes $t$ e o qui-quadrado, vinculados às somas de quadrados, 
são seriamente afetados. O teste $F$ é geralmente considerado como sendo 
razoavelmente robusto contra a não normalidade.

* No entanto, em algumas situações, não é apropriado presumir a normalidade. 
Em cenários com dados de contagem resulta mais conveniente o uso de distribuições 
discretas, por exemplo: uma distribuição Poisson ou mesmo binomial. Em outros 
cenários resultará apropriado considerar distribuições assimétricas;

* O teorema de Gauss-Markov garante que a ausência de normalidade não afeta a 
qualidade dos estimados de MQO, i.e., os estimadores de MQO são os melhores 
estimadores lineares não-viesadas e de mínima variância, se as outras suposições
forem garantidas.


<br></br>

Para detalhes `r Citet(myBib, "montgomery:peck:2007")`, `r Citet(myBib, "yan:su:2009")` e `r Citet(myBib, "rawlings:1998")`.


---
class: animated, slideInRight

### Transformações - I

A aplicação de transformações na variável dependente é um recurso comumente usado
para atingir uma distribuição mais próxima da normal. 

A teoria estatística afirma que tal transformação existe se a distribuição da 
variável dependente original for conhecida. 
Muitas das transformações comuns (como o arcseno, a raiz quadrada, o 
logarítmo, entre outras) foram desenvolvidos para situações em que resulta
necessário que distribuição das variáveis aleatórias se aproxime a uma 
distribuição normal.

Em muitos casos, os dados da amostra fornecem as únicas informações disponíveis 
para determinar a transformação que permita tal aproximação.


A familia de transformações mais popular foi proposta por [Box & Cox (1964)](http://www.ime.usp.br/~abe/lista/pdfQWaCMboK68.pdf)<sup>1</sup>, 
cuja forma original é dada por


<div class="math">
$$
  \begin{aligned}
    Y^{(\lambda)}&=
    \begin{cases}
    \dfrac{Y^\lambda-1}{\lambda}, & \text{ se } \lambda\ne0;\\ \\
    \log Y, & \text{ se } \lambda=0.
    \end{cases}
  \end{aligned}
$$
</div>


***

<font size="3"><sup>1</sup>Box, G. E. P. and Cox, D. R. (1964). An analysis of transformations, Journal of the Royal Statistical Society, Series B, 26, 211-252.</font> 


---
class: animated, fadeIn

### Transformações - II

Box & Cox (1964) propõem uma forma generalizada da familia de transformações dada 
por 


<div class="math">
$$
  \begin{aligned}
    Y^{(\lambda_1,\lambda_2)}&=
    \begin{cases}
    \dfrac{(Y+\lambda_2)^{\lambda_1}-1}{\lambda_1}, & \text{ se } \lambda_1\ne0;\\ \\
    \log (Y+\lambda_2), & \text{ se } \lambda_1=0.
    \end{cases}
  \end{aligned}
$$
</div>

Na prática, $\lambda_2$ pode ser escolhido tal que $Y+\lambda_2>0$.

> - O principal objetivo das transformações Box-Cox é garantir a usual suposição 
de normalidade para o modelo de regressão linear;
- Para estimar o valor de $\lambda$ os autores sugerem duas aproximações:
Máxima verossimilhança e máxima verossimilhança perfilada. Ambos os métodos
facilitam o cálculo de um intervalode confiança aproximado para $\lambda$ 
devido à distribuição assintótica do estimador de máxima verossimilhança.

--

<font size="5">Claramente nem em todos os cenários a transformação de Box-Cox será
uma opção satisfatória, mesmo quando o melhor parâmetro da transformação for escolhido.
</font>


---
class: animated, slideInRight

### Transformações - III

Desde o trabalho de Box e Cox (1964), houve muitos modificações propostas. 

* Schlesselman(1971)<sup>1</sup>:

<div class="math">
$$
  \begin{aligned}
    Y^{\lambda}&=
    \begin{cases}
    \dfrac{Y^\lambda-c^\lambda}{\lambda}, & \text{ se } \lambda\ne0;\\ \\
    Y, & \text{ se } \lambda=0,
    \end{cases}
  \end{aligned}
$$
</div>

onde $c$ é uma constante positiva arbitrária e com as mesmas unidades de medida 
da variável $Y$.

***

<font size="3"><sup>1</sup>Schlesselman, J. (1971) Power Families: A Note on the  Box and Cox Transformation. 
Journal of the Royal Statistical Society, Ser. B. 33:307-311.</font> 


---
class: animated, slideInRight

### Transformações - IV

* Manly (1976)<sup>1</sup>:

<div class="math">
$$
  \begin{aligned}
    Y^{\lambda}&=
    \begin{cases}
    \dfrac{\exp\{\lambda\,Y\}-1}{\lambda}, & \text{ se } \lambda\ne0;\\ \\
    \log \left(\frac{Y}{c}\right), & \text{ se } \lambda=0,
    \end{cases}
  \end{aligned}
$$
</div>

De acordo com os autores, a transformação apresenta bom desempenho quando aplicada
em dados com distribuição unimodal com um pouco de viés, mas não é muito útil 
para distribuições bimodais ou em distribuições com formato de U.

***

<font size="3"><sup>1</sup>Manly, B. F. (1976) Exponential Data Transformations. Statistician. 25(1): 37-42.</font> 

---
class: animated, slideInRight

### Transformações - V

* Yeo & Johnson (2000)<sup>1</sup> propõem uma versão modificada da proposta de
Box & Cox (1964):

<div class="math">
$$
  \begin{aligned}
    Y^{\lambda}&=
    \begin{cases}
    \dfrac{(Y+1)^{\lambda}-1}{\lambda}, & \text{ se } Y\ge0, \lambda\ne0;\\
    \log(Y+1), & \text{ se } Y\ge0, \lambda=0;\\
    -\dfrac{(1-Y)^{2-\lambda}-1}{2-\lambda}, & \text{ se } Y<0, \lambda\ne2;\\ 
    -\log\left(1-Y\right), & \text{ se } Y<0, \lambda=2.
    \end{cases}
  \end{aligned}
$$
</div>

> Os autores encontraram o $\lambda$ ótimo é aquele que minimiza a distância 
Kullback-Leibler entre a distribuição normal e a distribuição transformada.

Sugere-se a leitura do seguinte artigo, onde são discutidas algumas vantagens da proposta:

Rahman M. and Pearson, L.M. (2007). *A Note on the Modified Box-Cox Transformation*.
Festschrift in honor of Distinguished Professor Mir Masoom Ali on the occasion of 
his retirement , May 18-19. 106-115.106-115.

*** 

<font size="3"><sup>1</sup>Yeo, I.K. and Johnson, R. (2000) A New Family of  Power Transformations to Improve Normality or Symmetry. Biometrika. 87: 954-959.</font> 


---
class: animated, slideInRight

### Transformações - VI

* John and Draper (1980)<sup>1</sup>:

<div class="math">
$$
  \begin{aligned}
    Y^{\lambda}&=
    \begin{cases}
    \mathrm{sgn}(Y)\dfrac{(|Y|+1)^{\lambda}-1}{\lambda}, & \text{ se } \lambda\ne0;\\ \\
    \mathrm{sgn}(Y)\log(|Y|+1), & \text{ se } \lambda=0,
    \end{cases}
  \end{aligned}
$$
</div>

onde

<div class="math">
$$
  \begin{aligned}
    \mathrm{sgn}(Y)&=
    \begin{cases}
    1, & \text{ se } Y\ge0;\\ \\
    -1, & \text{ se } Y<0.
    \end{cases}
  \end{aligned}
$$
</div>


> Funciona melhor nas distribuições um tanto simétricas.


***

<font size="3"><sup>1</sup>Peter J. Bickel & Kjell A. Doksum (1981) An Analysis of Transformations Revisited, Journal of the American Statistical Association, 76:374, 296-311,</font> 

---
class: animated, slideInRight

### Transformações - VII

* Bickel and Doksum(1981)<sup>1</sup>:

<div class="math">
$$
  \begin{aligned}
    Y^{\lambda}&=\dfrac{|Y|^{\lambda}\mathrm{sgn}(Y)-1}{\lambda},
  \end{aligned}
$$
</div>

para $\lambda>0$ e

<div class="math">
$$
  \begin{aligned}
    \mathrm{sgn}(Y)&=
    \begin{cases}
    1, & \text{ se } Y\ge0;\\ \\
    -1, & \text{ se } Y<0.
    \end{cases}
  \end{aligned}
$$

</div>


***

<font size="3"><sup>1</sup>Bickel, P. J.  & Doksum, K. A. (1981) An Analysis of Transformations Revisited, Journal of the American Statistical Association, 76:374, 296-311.</font> 


**Outras referências:**

<font size="3">Abbasi, B., Niaki, S.T.A. and Seyedan, S.E. (2011) A Simple Transformation Method in Skewness Reduction. IJE Transactions A:Basics. 24(2): 169-175.</font>

<font size="3">Doksum, K. A. and Wong, C. (1983) Statistical Tests Based on Transformed Data. Journal of the American Statistical Association. 78: 411-417.</font> 

<font size="3">Gurka, M.J., Edwards, L.J. and Nylander-French, L. (2007) Testing Transformations for the Linear Mixed Model. Computational Statistics & Data Analysis. 51: 4297-4307.</font> 

---
class: animated, lightSpeedIn
# Referências

```{r refs, echo=FALSE, results="asis"}
PrintBibliography(myBib, .opts = list(check.entries = FALSE))
```

---
class: animated, hide-logo, bounceInDown
## Política de proteção aos direitos autorais

> <span style="color:grey">O conteúdo disponível consiste em material protegido pela legislação brasileira, sendo certo que, por ser
o detentor dos direitos sobre o conteúdo disponível na plataforma, o **LECON** e o **NEAEST** detém direito
exclusivo de usar, fruir e dispor de sua obra, conforme Artigo 5<sup>o</sup>, inciso XXVII, da Constituição Federal
e os Artigos 7<sup>o</sup> e 28<sup>o</sup>, da Lei 9.610/98.
A divulgação e/ou veiculação do conteúdo em sites diferentes à plataforma e sem a devida autorização do
**LECON** e o **NEAEST**, pode configurar violação de direito autoral, nos termos da Lei 9.610/98, inclusive podendo
caracterizar conduta criminosa, conforme Artigo 184<sup>o</sup>, §1<sup>o</sup> a 3<sup>o</sup>, do Código Penal.
É considerada como contrafação a reprodução não autorizada, integral ou parcial, de todo e qualquer
conteúdo disponível na plataforma.</span>

.pull-left[
```{r, out.width='50%', fig.align='center', fig.cap='',echo=FALSE}
knitr::include_graphics("images/logo_lecon.png")
```
]
.pull-right[
```{r, out.width='50%', fig.align='center', fig.cap='',echo=FALSE}
knitr::include_graphics("images/logo_neaest.png")
```
]
<br></br>
.center[
[https://lecon.ufes.br](https://lecon.ufes.br/) &emsp; &emsp;  &emsp; &emsp; [https://analytics.ufes.br](https://analytics.ufes.br)
]

<font size="2"><span style="color:grey">Material elaborado pela equipe LECON/NEAEST: 
Alessandro J. Q. Sarnaglia, Bartolomeu Zamprogno, Fabio A. Fajardo, Luciana G. de Godoi 
e Nátaly A. Jiménez.</span></font>
