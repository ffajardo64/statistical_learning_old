---
title: "STA13824 - Análise de regressão"
subtitle: "Modelos de regressão com variáveis binárias"
author: "<br/><br/>"
institute: "LECON/DEST - UFES"
date: "Vitória, ES. - `r format(Sys.Date(), format='%d/%m/%Y')`"
output:
  xaringan::moon_reader:
    includes:
      after_body: ["insert-logo.html"]
    css: [xaringan-themer.css, "https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css"]
    lib_dir: libs
    nature:
      ratio: '16:9' 
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

class: animated, fadeIn
```{r xaringan-themer, include=FALSE, warning=FALSE}
library("xaringanthemer"); library("dplyr"); library("DT"); library("plotly")
style_mono_light(base_color = "#23395b")
```
```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```
```{r, load_refs, include=FALSE, cache=FALSE}
library("RefManageR"); library("bibtex")
BibOptions(check.entries = FALSE,
           bib.style = "authoryear",
           cite.style = "authoryear",
           style = "markdown",
           hyperlink = FALSE,
           dashed = FALSE)
myBib <- ReadBib("ref_ementa.bib", check = FALSE)
```

<style> body {text-align: justify} </style> <!-- Justify text. -->

### Variáveis dummies (ou indicadoras) - I

Geralmente na análise de regressão as covariáveis são consideradas como variáveis
quantitativas. Os modelos de regressão linear não estão restritos ao uso de 
variáveis quantitativas e outros tipos de variáveis podem ser consideradas na 
modelagem de um conjunto de observações, poe exemplo covariáveis de tipo 
qualitativo ou categorizadas. 

> Dado que as variáveis categóricas não têm uma escala natural de medida, 
devemos atribuir um conjunto de *níveis* a essa variáveis para determinar o 
efeito delas na variável resposta.

Para determinar esse efeito é necessário o uso de variáveis *dummies* ou 
*indicadoras.* A ideia é "quantificar" tais níveis formulando variáveis 
artificiais que assumem valores de $0$ ou $1$, onde $1$ indica a presença 
(ou posse) daquele nível e $0$ a ausência dele.

> Define-se uma variável *dummy* como uma covariável  definida como
$$\delta=\begin{cases}1, & \text{ Se a característica está presente};\\ 0, & \text{em caso contrário.}\end{cases}$$


Para detalhes `r Citet(myBib, "greene:2007")`, 
`r Citet(myBib, "gujarati:porter:gunasekar:2017")`, `r Citet(myBib, "rawlings:1998")`.

---
class: animated, slideInRight

### Variáveis dummies (ou indicadoras) - II

**Exemplo**: Considere um modelo de regressão que usa dados anuais no período
$1930, 1931, \ldots, 1959, 1960$, dado por

$$C_i=\beta_0+\beta_1\,r_i+\epsilon_i, \quad i=1,2,\ldots,n,$$
onde $C_i$ representa o _consumo_ e  $r_i$ e a _renda_.

Suponha que essa relação sofre um efeito em determinado período de tempo. Dessa
forma, um modelo apropriado seria

$$C_i=\beta_{0i}+\beta_1\, r_i+\epsilon_i,$$
onde $\beta_{0i}=\beta_0+\gamma\delta_i$, com

$$
\delta=
\begin{cases}
1, & \text{ Se o ano for 1941 a 1945}; \quad \text{(durante a guerra)}\\ 
0, & \text{em caso contrário.}
\end{cases}
$$

Outra forma de escrever 

$$C_i=\beta_0+\gamma\delta_i+\beta_1\, r_i+\epsilon_i.$$
---
class: animated, slideInRight

### Variáveis dummies (ou indicadoras) - III

Daí, temos que

* **Durante a Guerra**: $\quad  \mathbb{E}[C_i]=(\beta_0+\gamma)+\beta_1\,r_i$
* **Durante a "não guerra"**:  $\quad  \mathbb{E}[C_i]=\beta_0+\beta_1\,r_i$

> Esse tipo de variável *dummy* é chamada de **dummy de intercepto**.

Nesse cenário, é possível estimar e avaliar o efeito da **guerra** sobre o 
_consumo_. Considere

$$\delta=\mathbb{E}\left[C|\delta=1,\ r\right]-\mathbb{E}\left[C|\delta=0,\ r\right]=(\beta_0+\gamma)+\beta_1\,r_i-\beta_0+\beta_1\,r_i.$$
Dessa forma, pode-se testar se houve de fato alteração no padrão de _consumo_
durante a guerra.

$$H_0: ``\text{A relação é a mesma em toda a amostra}"\\ H_1: ``\text{A relação é diferente durante a guerra}"$$
ou

$$H_0: \ \delta=0 \quad H_1:\ \delta<0.$$
---
background-image: url("images/dummies.png")
background-size: contain

class: animated, slideInRight
### Variáveis dummies (ou indicadoras) - IV


---
class: animated, slideInRight

### Variáveis dummies (ou indicadoras) - V

Se supormos que a queda no _consumo_ deve ser maior nos estratos mais altos de
_renda_, isso significa que existe uma *interação* entre **guerra/não guerra** e **renda**.

Um modelo apropriado seria dado por

$$\mathbb{E}[C_i]=\beta_0+(\beta_1+\gamma\delta_i)\ r_i=\beta_0+\beta_1\ r_i+\gamma\delta_i\ r_i.$$
> Esse tipo de variável *dummy* é chamada de **dummy de interação**.

Dessa forma, pode-se testar se houve de fato alteração no padrão de _consumo_
durante a guerra.

$$H_0: \ \delta=0 \quad H_1:\ \delta<0.$$
---
background-image: url("images/dummiesII.png")
background-size: contain

class: animated, slideInRight
### Variáveis dummies (ou indicadoras) - VI


---
class: animated, slideInRight

### Variáveis dummies (ou indicadoras) - VII

Pode ser que os dois efeitos (sobre o intercepto e sobre a inclinação) ocurram
simultaneamente.

Um modelo apropriado seria dado por

$$\mathbb{E}[C_i]=\beta_{0i}+\beta_{1i}\ r_i,$$
onde $\beta_{0i}=\beta_0+\gamma\delta_i$ e $\beta_{1i}=\beta_1+\psi\delta_i$. 
Dessa forma,

$$\mathbb{E}[C_i]=\beta_0+\gamma\delta_i+\beta_1\ r_i+\psi\delta_i\ r_i,$$
Dessa forma, pode-se testar se houve de fato alteração no padrão de _consumo_
durante a guerra da seguinte forma

$$H_0: \ \gamma=\delta=0 \quad H_1:\ ``\text{Não } H_0".$$
Para avaliar $H_0$ use um teste $F$.

> No caso que use o modelo completo, i.e.  
$$C_i=\beta_0+\beta_1\ r_i+\gamma\delta_{1i}+\psi\delta_{2i}+\epsilon_i,$$
as colunas da matriz $\mathbf{X}$ são linearmente dependentes, ou seja, a matriz
$\mathbf{X}'\mathbf{X}$ é **singular**. Isso é chamado de *armadilha das dummies.*

---
class: animated, slideInRight

### Variáveis dummies (ou indicadoras) - VII

#### Algumas considerações

* Se houver $m$ categorias, use $m-1$ variáveis _dummies_. No caso de usar uma
_dummy_ para cada categoria será um cenário de **colinearidade perfeita**;

* A categoria para a qual nenhuma _dummy_ é atribuída é chamada de 
**categoria de controle** ou **categoria de referência**;

* A escolha da categoria de referência fica a critério do pesquisador e será
determinado pelo cenário sob estudo;

* O valor de $\beta_0$ representa o valor médio da categoria de referência;

* Uma forma de contornar o problema da *armadilha das dummies* é introduzir 
tantas variáveis _dummies_ quanto número de categorias daquela variável, contanto
que não seja considerado intercepto no modelo.


---
class: animated, slideInRight

### Variáveis dummies (ou indicadoras) - VII

---
class: animated, lightSpeedIn
# Referências

```{r refs, echo=FALSE, results="asis"}
PrintBibliography(myBib, .opts = list(check.entries = FALSE))
```

---
class: animated, hide-logo, bounceInDown
## Política de proteção aos direitos autorais

> <span style="color:grey">O conteúdo disponível consiste em material protegido pela legislação brasileira, sendo certo que, por ser
o detentor dos direitos sobre o conteúdo disponível na plataforma, o **LECON** e o **NEAEST** detém direito
exclusivo de usar, fruir e dispor de sua obra, conforme Artigo 5<sup>o</sup>, inciso XXVII, da Constituição Federal
e os Artigos 7<sup>o</sup> e 28<sup>o</sup>, da Lei 9.610/98.
A divulgação e/ou veiculação do conteúdo em sites diferentes à plataforma e sem a devida autorização do
**LECON** e o **NEAEST**, pode configurar violação de direito autoral, nos termos da Lei 9.610/98, inclusive podendo
caracterizar conduta criminosa, conforme Artigo 184<sup>o</sup>, §1<sup>o</sup> a 3<sup>o</sup>, do Código Penal.
É considerada como contrafação a reprodução não autorizada, integral ou parcial, de todo e qualquer
conteúdo disponível na plataforma.</span>

.pull-left[
```{r, out.width='50%', fig.align='center', fig.cap='',echo=FALSE}
knitr::include_graphics("images/logo_lecon.png")
```
]
.pull-right[
```{r, out.width='50%', fig.align='center', fig.cap='',echo=FALSE}
knitr::include_graphics("images/logo_neaest.png")
```
]
<br></br>
.center[
[https://lecon.ufes.br](https://lecon.ufes.br/) &emsp; &emsp;  &emsp; &emsp; [https://analytics.ufes.br](https://analytics.ufes.br)
]

<font size="2"><span style="color:grey">Material elaborado pela equipe LECON/NEAEST: 
Alessandro J. Q. Sarnaglia, Bartolomeu Zamprogno, Fabio A. Fajardo, Luciana G. de Godoi 
e Nátaly A. Jiménez.</span></font>
